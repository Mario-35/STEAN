"use strict";var TokenType,Lexer,__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0}),exports.Lexer=exports.LexerToken=exports.Token=exports.LexerTokenType=exports.TokenType=void 0;const utils_1=__importDefault(require("./utils"));!function(e){e.Literal="Literal",e.ArrayOrObject="ArrayOrObject",e.Array="Array",e.Object="Object",e.Property="Property",e.Annotation="Annotation",e.Enum="Enum",e.EnumValue="EnumValue",e.EnumMemberValue="EnumMemberValue",e.Identifier="Identifier",e.QualifiedEntityTypeName="QualifiedEntityTypeName",e.QualifiedComplexTypeName="QualifiedComplexTypeName",e.ODataIdentifier="ODataIdentifier",e.Collection="Collection",e.NamespacePart="NamespacePart",e.EntitySetName="EntitySetName",e.SingletonEntity="SingletonEntity",e.EntityTypeName="EntityTypeName",e.ComplexTypeName="ComplexTypeName",e.TypeDefinitionName="TypeDefinitionName",e.EnumerationTypeName="EnumerationTypeName",e.EnumerationMember="EnumerationMember",e.TermName="TermName",e.PrimitiveProperty="PrimitiveProperty",e.PrimitiveKeyProperty="PrimitiveKeyProperty",e.PrimitiveNonKeyProperty="PrimitiveNonKeyProperty",e.PrimitiveCollectionProperty="PrimitiveCollectionProperty",e.ComplexProperty="ComplexProperty",e.ComplexCollectionProperty="ComplexCollectionProperty",e.StreamProperty="StreamProperty",e.NavigationProperty="NavigationProperty",e.EntityNavigationProperty="EntityNavigationProperty",e.EntityCollectionNavigationProperty="EntityCollectionNavigationProperty",e.Action="Action",e.ActionImport="ActionImport",e.Function="Function",e.EntityFunction="EntityFunction",e.EntityCollectionFunction="EntityCollectionFunction",e.ComplexFunction="ComplexFunction",e.ComplexCollectionFunction="ComplexCollectionFunction",e.PrimitiveFunction="PrimitiveFunction",e.PrimitiveCollectionFunction="PrimitiveCollectionFunction",e.EntityFunctionImport="EntityFunctionImport",e.EntityCollectionFunctionImport="EntityCollectionFunctionImport",e.ComplexFunctionImport="ComplexFunctionImport",e.ComplexCollectionFunctionImport="ComplexCollectionFunctionImport",e.PrimitiveFunctionImport="PrimitiveFunctionImport",e.PrimitiveCollectionFunctionImport="PrimitiveCollectionFunctionImport",e.CommonExpression="CommonExpression",e.AndExpression="AndExpression",e.OrExpression="OrExpression",e.EqualsExpression="EqualsExpression",e.NotEqualsExpression="NotEqualsExpression",e.LesserThanExpression="LesserThanExpression",e.LesserOrEqualsExpression="LesserOrEqualsExpression",e.GreaterThanExpression="GreaterThanExpression",e.GreaterOrEqualsExpression="GreaterOrEqualsExpression",e.HasExpression="HasExpression",e.InExpression="InExpression",e.AddExpression="AddExpression",e.SubExpression="SubExpression",e.MulExpression="MulExpression",e.DivExpression="DivExpression",e.ModExpression="ModExpression",e.NotExpression="NotExpression",e.BoolParenExpression="BoolParenExpression",e.ParenExpression="ParenExpression",e.MethodCallExpression="MethodCallExpression",e.IsOfExpression="IsOfExpression",e.CastExpression="CastExpression",e.NegateExpression="NegateExpression",e.FirstMemberExpression="FirstMemberExpression",e.MemberExpression="MemberExpression",e.PropertyPathExpression="PropertyPathExpression",e.ImplicitVariableExpression="ImplicitVariableExpression",e.LambdaVariable="LambdaVariable",e.LambdaVariableExpression="LambdaVariableExpression",e.LambdaPredicateExpression="LambdaPredicateExpression",e.AnyExpression="AnyExpression",e.AllExpression="AllExpression",e.CollectionNavigationExpression="CollectionNavigationExpression",e.SimpleKey="SimpleKey",e.CompoundKey="CompoundKey",e.KeyValuePair="KeyValuePair",e.KeyPropertyValue="KeyPropertyValue",e.KeyPropertyAlias="KeyPropertyAlias",e.SingleNavigationExpression="SingleNavigationExpression",e.CollectionPathExpression="CollectionPathExpression",e.ComplexPathExpression="ComplexPathExpression",e.SinglePathExpression="SinglePathExpression",e.FunctionExpression="FunctionExpression",e.FunctionExpressionParameters="FunctionExpressionParameters",e.FunctionExpressionParameter="FunctionExpressionParameter",e.ParameterName="ParameterName",e.ParameterAlias="ParameterAlias",e.ParameterValue="ParameterValue",e.CountExpression="CountExpression",e.RefExpression="RefExpression",e.ValueExpression="ValueExpression",e.RootExpression="RootExpression",e.QueryOptions="QueryOptions",e.CustomQueryOption="CustomQueryOption",e.Expand="Expand",e.ExpandItem="ExpandItem",e.ExpandPath="ExpandPath",e.ExpandCountOption="ExpandCountOption",e.ExpandRefOption="ExpandRefOption",e.ExpandOption="ExpandOption",e.Levels="Levels",e.Search="Search",e.SearchExpression="SearchExpression",e.SearchParenExpression="SearchParenExpression",e.SearchNotExpression="SearchNotExpression",e.SearchOrExpression="SearchOrExpression",e.SearchAndExpression="SearchAndExpression",e.SearchTerm="SearchTerm",e.SearchPhrase="SearchPhrase",e.SearchWord="SearchWord",e.Filter="Filter",e.OrderBy="OrderBy",e.OrderByItem="OrderByItem",e.Skip="Skip",e.Top="Top",e.Log="Log",e.Format="Format",e.resultFormat="ResultFormat",e.entity="Entity",e.splitResult="SplitResult",e.interval="Interval",e.payload="Payload",e.Root="Root",e.Debug="Debug",e.InlineCount="InlineCount",e.Select="Select",e.SelectItem="SelectItem",e.SelectPath="SelectPath",e.AliasAndValue="AliasAndValue",e.SkipToken="SkipToken",e.Id="Id",e.Crossjoin="Crossjoin",e.AllResource="AllResource",e.ActionImportCall="ActionImportCall",e.FunctionImportCall="FunctionImportCall",e.EntityCollectionFunctionImportCall="EntityCollectionFunctionImportCall",e.EntityFunctionImportCall="EntityFunctionImportCall",e.ComplexCollectionFunctionImportCall="ComplexCollectionFunctionImportCall",e.ComplexFunctionImportCall="ComplexFunctionImportCall",e.PrimitiveCollectionFunctionImportCall="PrimitiveCollectionFunctionImportCall",e.PrimitiveFunctionImportCall="PrimitiveFunctionImportCall",e.FunctionParameters="FunctionParameters",e.FunctionParameter="FunctionParameter",e.ResourcePath="ResourcePath",e.CollectionNavigation="CollectionNavigation",e.CollectionNavigationPath="CollectionNavigationPath",e.SingleNavigation="SingleNavigation",e.PropertyPath="PropertyPath",e.ComplexPath="ComplexPath",e.BoundOperation="BoundOperation",e.BoundActionCall="BoundActionCall",e.BoundEntityFunctionCall="BoundEntityFunctionCall",e.BoundEntityCollectionFunctionCall="BoundEntityCollectionFunctionCall",e.BoundComplexFunctionCall="BoundComplexFunctionCall",e.BoundComplexCollectionFunctionCall="BoundComplexCollectionFunctionCall",e.BoundPrimitiveFunctionCall="BoundPrimitiveFunctionCall",e.BoundPrimitiveCollectionFunctionCall="BoundPrimitiveCollectionFunctionCall",e.ODataUri="ODataUri",e.Batch="Batch",e.Entity="Entity",e.Metadata="Metadata"}(TokenType||(exports.TokenType=TokenType={})),exports.LexerTokenType=TokenType;class Token{position;next;value;type;raw;metadata;constructor(e){this.position=e.position,this.next=e.next,this.value=e.value,this.type=e.type,this.raw=e.raw,e.metadata&&(this.metadata=e.metadata)}}exports.Token=Token,exports.LexerToken=Token,function(i){function n(e){return 48<=e&&e<=57}i.Token=exports.Token,i.TokenType=exports.TokenType,i.tokenize=function(e,t,n,o,i,r){return o=new exports.Token({position:t,next:n,value:o,type:i,raw:utils_1.default.stringify(e,t,n)}),r&&r.metadata&&(o.metadata=r.metadata,delete r.metadata),o},i.clone=function(e){return new exports.Token({position:e.position,next:e.next,value:e.value,type:e.type,raw:e.raw})},i.ALPHA=function(e){return 65<=e&&e<=90||97<=e&&e<=122||128<=e},i.DIGIT=n,i.HEEDING=function(e){return i.DIGIT(e)||i.AtoF(e)},i.AtoF=function(e){return 65<=e&&e<=70||97<=e&&e<=102},i.DQUOTE=function(e){return 34===e},i.SP=function(e){return 32===e},i.HTAB=function(e){return 9===e},i.VCHAR=function(e){return 33<=e&&e<=126},i.whitespaceLength=function(e,t){return utils_1.default.equals(e,t,"%20")||utils_1.default.equals(e,t,"%09")?3:i.SP(e[t])||i.HTAB(e[t])||32===e[t]||9===e[t]?1:void 0},i.OWS=function(e,t){let n=i.whitespaceLength(e,t=t||0);for(;n;)t+=n,n=i.whitespaceLength(e,t);return t},i.RWS=function(e,t){return i.OWS(e,t)},i.BWS=function(e,t){return i.OWS(e,t)},i.AT=function(e,t){return 64===e[t]?t+1:utils_1.default.equals(e,t,"%40")?t+3:void 0},i.COLON=function(e,t){return 58===e[t]?t+1:utils_1.default.equals(e,t,"%3A")?t+3:void 0},i.COMMA=function(e,t){return 44===e[t]?t+1:utils_1.default.equals(e,t,"%2C")?t+3:void 0},i.EQ=function(e,t){if(61===e[t])return t+1},i.SIGN=function(e,t){return 43===e[t]||45===e[t]?t+1:utils_1.default.equals(e,t,"%2B")?t+3:void 0},i.SEMI=function(e,t){return 59===e[t]?t+1:utils_1.default.equals(e,t,"%3B")?t+3:void 0},i.STAR=function(e,t){return 42===e[t]?t+1:utils_1.default.equals(e,t,"%2A")?t+3:void 0},i.SQUAT=function(e,t){return 39===e[t]?t+1:utils_1.default.equals(e,t,"%27")?t+3:void 0},i.OPEN=function(e,t){return 40===e[t]?t+1:utils_1.default.equals(e,t,"%28")?t+3:void 0},i.CLOSE=function(e,t){return 41===e[t]?t+1:utils_1.default.equals(e,t,"%29")?t+3:void 0},i.unreserved=function(e){return i.ALPHA(e)||i.DIGIT(e)||45===e||46===e||95===e||126===e},i.otherDelims=function(e,t){return 33===e[t]||43===e[t]?t+1:i.OPEN(e,t)||i.CLOSE(e,t)||i.STAR(e,t)||i.COMMA(e,t)||i.SEMI(e,t)},i.subDelims=function(e,t){return 36===e[t]||38===e[t]?t+1:i.SQUAT(e,t)||i.EQ(e,t)||i.otherDelims(e,t)},i.pctEncoded=function(e,t){return 37===e[t]&&i.HEEDING(e[t+1])&&i.HEEDING(e[t+2])?t+3:t},i.pctEncodedNoSQUOTE=function(e,t){return utils_1.default.equals(e,t,"%27")?t:i.pctEncoded(e,t)},i.pctEncodedUnescaped=function(e,t){return utils_1.default.equals(e,t,"%22")||utils_1.default.equals(e,t,"%3")||utils_1.default.equals(e,t,"%4")||utils_1.default.equals(e,t,"%5C")?t:i.pctEncoded(e,t)},i.pchar=function(e,t){return i.unreserved(e[t])?t+1:i.subDelims(e,t)||i.COLON(e,t)||i.AT(e,t)||i.pctEncoded(e,t)||t},i.pcarNoSQUOTE=function(e,t){return i.unreserved(e[t])||36===e[t]||38===e[t]?t+1:i.otherDelims(e,t)||i.EQ(e,t)||i.COLON(e,t)||i.AT(e,t)||i.pctEncodedNoSQUOTE(e,t)||t},i.qcharNoAMP=function(e,t){return i.unreserved(e[t])||58===e[t]||64===e[t]||47===e[t]||63===e[t]||36===e[t]||39===e[t]||61===e[t]?t+1:i.pctEncoded(e,t)||i.otherDelims(e,t)||t},i.qcharNoAMPDQUOTE=function(e,t){return null==i.BWS(e,t)||!i.unreserved(e[t])&&58!==e[t]&&64!==e[t]&&47!==e[t]&&63!==e[t]&&36!==e[t]&&39!==e[t]&&61!==e[t]?i.otherDelims(e,t)||i.pctEncodedUnescaped(e,t):t+1},i.base64char=function(e){return i.ALPHA(e)||i.DIGIT(e)||45===e||95===e},i.base64b16=function(e,t){var n=t;return(i.base64char(e[t])||i.base64char(e[t+1]))&&(t+=2,utils_1.default.is(e[t],"AEIMQUYcgkosw048"))?(61===e[++t]&&t++,t):n},i.base64b8=function(e,t){var n=t;return!i.base64char(e[t])||65!==e[++t]||81!==e[t]||103!==e[t]||119!==e[t]?n:(61===e[++t]&&61===e[t+1]&&(t+=2),t)},i.nanInfinity=function(e,t){return utils_1.default.equals(e,t,"NaN")||utils_1.default.equals(e,t,"-INF")||utils_1.default.equals(e,t,"INF")},i.oneToNine=function(e){return 48!==e&&i.DIGIT(e)},i.zeroToFiftyNine=function(e,t){return 48<=e[t]&&e[t]<=53&&i.DIGIT(e[t+1])?t+2:t},i.year=function(e,t){var n=t;let o=t;return 45===e[t]&&t++,48===e[t]&&(o=utils_1.default.required(e,t+1,i.DIGIT,3,3))||i.oneToNine(e[t])&&(o=utils_1.default.required(e,t+1,i.DIGIT,3))?o:n},i.month=function(e,t){return 48===e[t]&&i.oneToNine(e[t+1])||49===e[t]&&48<=e[t+1]&&e[t+1]<=50?t+2:t},i.day=function(e,t){return 48===e[t]&&i.oneToNine(e[t+1])||(49===e[t]||50===e[t])&&i.DIGIT(e[t+1])||51===e[t]&&(48===e[t+1]||49===e[t+1])?t+2:t},i.hour=function(e,t){return(48===e[t]||49===e[t])&&i.DIGIT(e[t+1])||50===e[t]&&(48===e[t+1]||49===e[t+1]||50===e[t+1]||51===e[t+1])?t+2:t},i.minute=function(e,t){return i.zeroToFiftyNine(e,t)},i.second=function(e,t){return i.zeroToFiftyNine(e,t)},i.fractionalSeconds=function(e,t){return utils_1.default.required(e,t,n,1,12)},i.geographyPrefix=function(e,t){return utils_1.default.equals(e,t,"geography")?t+9:t},i.geometryPrefix=function(e,t){return utils_1.default.equals(e,t,"geometry")?t+8:t},i.identifierLeadingCharacter=function(e){return i.ALPHA(e)||95===e},i.identifierCharacter=function(e){return i.identifierLeadingCharacter(e)||i.DIGIT(e)},i.beginObject=function(e,t){var n,o=i.BWS(e,t);if(null!=o)return n=t,t=o,utils_1.default.equals(e,t,"{")?t++:utils_1.default.equals(e,t,"%7B")&&(t+=3),t===o?n:i.BWS(e,t)},i.endObject=function(e,t){var n,o=i.BWS(e,t);if(null!=o)return n=t,t=o,utils_1.default.equals(e,t,"}")?t++:utils_1.default.equals(e,t,"%7D")&&(t+=3),t===o?n:i.BWS(e,t)},i.beginArray=function(e,t){var n,o=i.BWS(e,t);if(null!=o)return n=t,t=o,utils_1.default.equals(e,t,"[")?t++:utils_1.default.equals(e,t,"%5B")&&(t+=3),t===o?n:i.BWS(e,t)},i.endArray=function(e,t){var n,o=i.BWS(e,t);if(null!=o)return n=t,t=o,utils_1.default.equals(e,t,"]")?t++:utils_1.default.equals(e,t,"%5D")&&(t+=3),t===o?n:t},i.quotationMark=function(e,t){return i.DQUOTE(e[t])?t+1:utils_1.default.equals(e,t,"%22")?t+3:t},i.nameSeparator=function(e,t){var n,o=i.BWS(e,t);if(null!=o)return n=t,(o=i.COLON(e,t=o))?i.BWS(e,t=o):n},i.valueSeparator=function(e,t){var n,o=i.BWS(e,t);if(null!=o)return n=t,(o=i.COMMA(e,t=o))?i.BWS(e,t=o):n},i.escape=function(e,t){return utils_1.default.equals(e,t,"\\")?t+1:utils_1.default.equals(e,t,"%5C")?t+3:t}}(Lexer||(exports.Lexer=Lexer={})),exports.default=Lexer;
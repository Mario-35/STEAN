"use strict";var PrimitiveLiteral,__importDefault=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(exports,"__esModule",{value:!0});const utils_1=__importDefault(require("./utils")),lexer_1=__importDefault(require("./lexer")),nameOrIdentifier_1=__importDefault(require("./nameOrIdentifier"));!function(u){function l(e,t){if(utils_1.default.equals(e,t,"Point")||utils_1.default.equals(e,t,"POINT")){var l=t,t=u.pointData(e,t+=5);if(t)return lexer_1.default.tokenize(e,l,t.next,t,lexer_1.default.TokenType.Literal)}}function r(e,t){return u.fullGeoLiteralFactory(e,t,u.pointLiteral)}function i(e,t,l,r,i){r=r(e,t);if(r!==t){var u=t,r=(t=r,lexer_1.default.SQUAT(e,t));if(r){i=i(e,t=r);if(i&&(t=i.next,r=lexer_1.default.SQUAT(e,t)))return t=r,lexer_1.default.tokenize(e,u,t,l,lexer_1.default.TokenType.Literal)}}}u.nullValue=function(e,t){if(utils_1.default.equals(e,t,"null"))return lexer_1.default.tokenize(e,t,t+4,"null",lexer_1.default.TokenType.Literal)},u.booleanValue=function(e,t){return utils_1.default.equals(e,t,"true")?lexer_1.default.tokenize(e,t,t+4,"Edm.Boolean",lexer_1.default.TokenType.Literal):utils_1.default.equals(e,t,"false")?lexer_1.default.tokenize(e,t,t+5,"Edm.Boolean",lexer_1.default.TokenType.Literal):void 0},u.guidValue=function(e,t){if(utils_1.default.required(e,t,lexer_1.default.HEEDING,8,8)&&45===e[t+8]&&utils_1.default.required(e,t+9,lexer_1.default.HEEDING,4,4)&&45===e[t+13]&&utils_1.default.required(e,t+14,lexer_1.default.HEEDING,4,4)&&45===e[t+18]&&utils_1.default.required(e,t+19,lexer_1.default.HEEDING,4,4)&&45===e[t+23]&&utils_1.default.required(e,t+24,lexer_1.default.HEEDING,12))return lexer_1.default.tokenize(e,t,t+36,"Edm.Guid",lexer_1.default.TokenType.Literal)},u.lbyteValue=function(e,t){var l=t,r=lexer_1.default.SIGN(e,t);return r&&(t=r),(r=utils_1.default.required(e,t,lexer_1.default.DIGIT,1,3))&&!lexer_1.default.DIGIT(e[r])&&-128<=(t=parseInt(utils_1.default.stringify(e,l,r),10))&&t<=127?lexer_1.default.tokenize(e,l,r,"Edm.SByte",lexer_1.default.TokenType.Literal):void 0},u.byteValue=function(e,t){var l,r=utils_1.default.required(e,t,lexer_1.default.DIGIT,1,3);return r&&!lexer_1.default.DIGIT(e[r])&&0<=(l=parseInt(utils_1.default.stringify(e,t,r),10))&&l<=255?lexer_1.default.tokenize(e,t,r,"Edm.Byte",lexer_1.default.TokenType.Literal):void 0},u.int16Value=function(e,t){var l=t,r=lexer_1.default.SIGN(e,t);return r&&(t=r),(r=utils_1.default.required(e,t,lexer_1.default.DIGIT,1,5))&&!lexer_1.default.DIGIT(e[r])&&-32768<=(t=parseInt(utils_1.default.stringify(e,l,r),10))&&t<=32767?lexer_1.default.tokenize(e,l,r,"Edm.Int16",lexer_1.default.TokenType.Literal):void 0},u.int32Value=function(e,t){var l=t,r=lexer_1.default.SIGN(e,t);return r&&(t=r),(r=utils_1.default.required(e,t,lexer_1.default.DIGIT,1,10))&&!lexer_1.default.DIGIT(e[r])&&-2147483648<=(t=parseInt(utils_1.default.stringify(e,l,r),10))&&t<=2147483647?lexer_1.default.tokenize(e,l,r,"Edm.Int32",lexer_1.default.TokenType.Literal):void 0},u.int64Value=function(e,t){var l=t,r=lexer_1.default.SIGN(e,t);return r&&(t=r),(r=utils_1.default.required(e,t,lexer_1.default.DIGIT,1,19))&&!lexer_1.default.DIGIT(e[r])&&"0"<=(t=utils_1.default.stringify(e,t,r))&&t<=(45===e[l]?"9223372036854775808":"9223372036854775807")?lexer_1.default.tokenize(e,l,r,"Edm.Int64",lexer_1.default.TokenType.Literal):void 0},u.decimalValue=function(t,e){var l=e,r=lexer_1.default.SIGN(t,e);if(r&&(e=r),r=utils_1.default.required(t,e,lexer_1.default.DIGIT,1)){let e=r;if(46===t[r]&&(e=utils_1.default.required(t,r+1,lexer_1.default.DIGIT,1))&&e!==r+1&&101!==t[e])return lexer_1.default.tokenize(t,l,e,"Edm.Decimal",lexer_1.default.TokenType.Literal)}},u.doubleValue=function(l,r){var e=r;let i=r;var u=lexer_1.default.nanInfinity(l,r);if(u)i+=u;else{u=lexer_1.default.SIGN(l,r),u=(u&&(r=u),utils_1.default.required(l,r,lexer_1.default.DIGIT,1));if(!u)return;let t=u;if(46!==l[u])return;if((t=utils_1.default.required(l,u+1,lexer_1.default.DIGIT,1))===u+1)return;if(101===l[t]){let e=t+1;r=lexer_1.default.SIGN(l,e),u=(r&&(e=r),utils_1.default.required(l,e,lexer_1.default.DIGIT,1));u&&(i=u)}else i=t}return lexer_1.default.tokenize(l,e,i,"Edm.Double",lexer_1.default.TokenType.Literal)},u.singleValue=function(e,t){return(e=u.doubleValue(e,t))&&(e.value="Edm.Single"),e},u.stringValue=function(e,t){var l=t;let r=lexer_1.default.SQUAT(e,l);if(r){for(t=r;t<e.length;)if(r=lexer_1.default.SQUAT(e,t)){if(t=r,!(r=lexer_1.default.SQUAT(e,t))){var i=lexer_1.default.CLOSE(e,t),u=lexer_1.default.COMMA(e,t),a=38===e[t],n=lexer_1.default.pcarNoSQUOTE(e,t);if("number"==typeof n&&t<n&&!a&&!i&&!u&&lexer_1.default.RWS(e,t)===t)return;break}t=r}else{n=lexer_1.default.RWS(e,t),a=lexer_1.default.pcarNoSQUOTE(e,t);if(null!=n&&null!=a){i=Math.max(n,a);if(i===t)return;t=i}}if(r=lexer_1.default.SQUAT(e,t-1)||lexer_1.default.SQUAT(e,t-3))return t=r,lexer_1.default.tokenize(e,l,t,"Edm.String",lexer_1.default.TokenType.Literal)}},u.durationValue=function(l,r){if(utils_1.default.equals(l,r,"duration")){var e=r,i=(r+=8,lexer_1.default.SQUAT(l,r));if(i){r=i;var u=lexer_1.default.SIGN(l,r);if(80===l[r=u?u:r]){r++;u=utils_1.default.required(l,r,lexer_1.default.DIGIT,1);if(u!==r||84===l[r+1]){68===l[r=u]&&r++;let t=r;if(84===l[r]){r++;const a=function(){if(lexer_1.default.SQUAT(l,r))return r;var e=utils_1.default.required(l,r,lexer_1.default.DIGIT,1);if(e!==r){if(83===l[r=e])return t=r+1;if(46!==l[r])return 72===l[r]||77===l[r]?(r++,t=r,a()):void 0;r++;e=utils_1.default.required(l,r,lexer_1.default.DIGIT,1);return e!==r&&83===l[e]?t=e+1:void 0}};if(!a())return}if(i=lexer_1.default.SQUAT(l,t))return t=i,lexer_1.default.tokenize(l,e,t,"Edm.Duration",lexer_1.default.TokenType.Literal)}}}}},u.binaryValue=function(t,l){var r=l;if(utils_1.default.equals(t,l,"binary")){l+=6;let e=lexer_1.default.SQUAT(t,l);if(e){for(l=e;l<t.length&&!(e=lexer_1.default.SQUAT(t,l));){var i=lexer_1.default.base64b16(t,l),u=lexer_1.default.base64b8(t,l);i&&u&&(l<(i=Math.max(i,u))?l=i:lexer_1.default.base64char(t[l])&&lexer_1.default.base64char(t[l+1])&&lexer_1.default.base64char(t[l+2])&&lexer_1.default.base64char(t[l+3])?l+=4:l++)}return e&&(l=e),lexer_1.default.tokenize(t,r,l,"Edm.Binary",lexer_1.default.TokenType.Literal)}}},u.dateValue=function(e,t){var l=lexer_1.default.year(e,t);if(l&&l!==t&&45===e[l]){var r=lexer_1.default.month(e,l+1);if(r&&r!==l+1&&45===e[r]){l=lexer_1.default.day(e,r+1);if(l&&l!==r+1&&84!==e[l])return lexer_1.default.tokenize(e,t,l,"Edm.Date",lexer_1.default.TokenType.Literal)}}},u.dateTimePeriodValue=function(l,r){var i=lexer_1.default.year(l,r);if(i&&i!==r&&45===l[i]){var u=lexer_1.default.month(l,i+1);if(u&&u!==i+1&&45===l[u]){i=lexer_1.default.day(l,u+1);if(i&&i!==u+1&&84===l[i]){u=lexer_1.default.hour(l,i+1);if(u){let e=lexer_1.default.COLON(l,u);if(u!==e&&e){i=lexer_1.default.minute(l,u+1);if(i!==u+1&&i){let t=i;if(e=lexer_1.default.COLON(l,i)){u=lexer_1.default.second(l,e);if(u){if(u===e)return;if(46===l[u]){i=lexer_1.default.fractionalSeconds(l,u+1);if(i===u+1)return;i&&(t=i)}else t=u}}const n=lexer_1.default.SIGN(l,t);if(90===l[t])t++;else{if(!n)return;{i=lexer_1.default.hour(l,n);if(!i)return;const e=lexer_1.default.COLON(l,i);if(i===n||!e)return;u=lexer_1.default.minute(l,e);if(!u||u===e)return;t=u}}if(47===l[t]){i=lexer_1.default.year(l,t+1);if(!i)return;if(i===r||45!==l[i])return;u=lexer_1.default.month(l,i+1);if(!u)return;if(u===i+1||45!==l[u])return;i=lexer_1.default.day(l,u+1);if(!i)return;if(i===u+1||84!==l[i])return;u=lexer_1.default.hour(l,i+1);if(!u)return;i=lexer_1.default.COLON(l,u);if(u===i||!i)return;var a=lexer_1.default.minute(l,u+1);if(a===u+1)return;if(!a)return;if(t=a,i=lexer_1.default.COLON(l,a)){u=lexer_1.default.second(l,i);if(u){if(u===i)return;if(46===l[u]){a=lexer_1.default.fractionalSeconds(l,u+1);if(a===u+1)return;a&&(t=a)}else t=u}}const n=lexer_1.default.SIGN(l,t);if(90===l[t])t++;else{if(!n)return;{i=lexer_1.default.hour(l,n);if(!i)return;const e=lexer_1.default.COLON(l,i);if(i===n||!e)return;a=lexer_1.default.minute(l,e);if(!a||a===e)return;t=a}}}return lexer_1.default.tokenize(l,r,t,"Edm.DateTimePeriod",lexer_1.default.TokenType.Literal)}}}}}}},u.dateTimeOffsetValue=function(l,r){var i=lexer_1.default.year(l,r);if(i&&i!==r&&45===l[i]){var u=lexer_1.default.month(l,i+1);if(u&&u!==i+1&&45===l[u]){i=lexer_1.default.day(l,u+1);if(i&&i!==u+1&&84===l[i]){u=lexer_1.default.hour(l,i+1);if(u){let e=lexer_1.default.COLON(l,u);if(u!==e&&e){i=lexer_1.default.minute(l,u+1);if(i!==u+1&&i){let t=i;if(e=lexer_1.default.COLON(l,i)){u=lexer_1.default.second(l,e);if(u){if(u===e)return;if(46===l[u]){i=lexer_1.default.fractionalSeconds(l,u+1);if(i===u+1)return;i&&(t=i)}else t=u}}i=lexer_1.default.SIGN(l,t);if(90===l[t])t++;else{if(!i)return;{u=lexer_1.default.hour(l,i);if(!u)return;const e=lexer_1.default.COLON(l,u);if(u===i||!e)return;u=lexer_1.default.minute(l,e);if(!u||u===e)return;t=u}}return lexer_1.default.tokenize(l,r,t,"Edm.DateTimeOffset",lexer_1.default.TokenType.Literal)}}}}}}},u.timeOfDayValue=function(t,l){var r=lexer_1.default.hour(t,l);if(r){var i=lexer_1.default.COLON(t,r);if(r!==l&&i){r=lexer_1.default.minute(t,i);if(r&&r!==i){let e=r;if(i=lexer_1.default.COLON(t,r)){r=lexer_1.default.second(t,i);if(!r||r===i)return;if(46===t[r]){i=lexer_1.default.fractionalSeconds(t,r+1);if(!i||i===r+1)return;e=i}else e=r}return lexer_1.default.tokenize(t,l,e,"Edm.TimeOfDay",lexer_1.default.TokenType.Literal)}}}},u.positionLiteral=function(e,t){var l=u.doubleValue(e,t);if(l){var r=lexer_1.default.RWS(e,l.next);if(r&&r!==l.next){r=u.doubleValue(e,r);if(r)return lexer_1.default.tokenize(e,t,r.next,{longitude:l,latitude:r},lexer_1.default.TokenType.Literal)}}},u.pointData=function(e,t){if(r=lexer_1.default.OPEN(e,t)){var l=t,r=u.positionLiteral(e,t=r);if(r){t=r.next;var i=lexer_1.default.CLOSE(e,t);if(i)return t=i,lexer_1.default.tokenize(e,l,t,r,lexer_1.default.TokenType.Literal)}}},u.lineStringData=function(e,t){return u.multiGeoLiteralFactory(e,t,"",u.positionLiteral)},u.ringLiteral=function(e,t){return u.multiGeoLiteralFactory(e,t,"",u.positionLiteral)},u.polygonData=function(e,t){return u.multiGeoLiteralFactory(e,t,"",u.ringLiteral)},u.sridLiteral=function(e,t){if(utils_1.default.equals(e,t,"SRID")){var l=t,r=(t+=4,lexer_1.default.EQ(e,t));if(r){t++;r=utils_1.default.required(e,t,lexer_1.default.DIGIT,1,5);if(r){t=r;r=lexer_1.default.SEMI(e,t);if(r)return t=r,lexer_1.default.tokenize(e,l,t,"SRID",lexer_1.default.TokenType.Literal)}}}},u.pointLiteral=l,u.polygonLiteral=function(e,t){if(utils_1.default.equals(e,t,"Polygon")||utils_1.default.equals(e,t,"POLYGON")){var l=t,t=u.polygonData(e,t+=7);if(t)return lexer_1.default.tokenize(e,l,t.next,t,lexer_1.default.TokenType.Literal)}},u.collectionLiteral=function(e,t){return u.multiGeoLiteralFactory(e,t,"Collection",u.geoLiteral)},u.lineStringLiteral=function(e,t){if(utils_1.default.equals(e,t,"LineString")||utils_1.default.equals(e,t,"LINESTRING")){var l=t,r=u.lineStringData(e,t+=10);if(r)return t=r.next,lexer_1.default.tokenize(e,l,t,r,lexer_1.default.TokenType.Literal)}},u.multiLineStringLiteral=function(e,t){return u.multiGeoLiteralOptionalFactory(e,t,"MultiLineString",u.lineStringData)},u.multiPointLiteral=function(e,t){return u.multiGeoLiteralOptionalFactory(e,t,"MultiPoint",u.pointData)},u.multiPolygonLiteral=function(e,t){return u.multiGeoLiteralOptionalFactory(e,t,"MultiPolygon",u.polygonData)},u.multiGeoLiteralFactory=function(t,l,r,i){if(utils_1.default.equals(t,l,r+"(")){var u=l,a=[];let e=i(t,l+=r.length+1);if(e){for(l=e.next;e;){a.push(e);var n=lexer_1.default.CLOSE(t,l);if(n){l=n;break}n=lexer_1.default.COMMA(t,l);if(!n)return;if(l=n,!(e=i(t,l)))return;l=e.next}return lexer_1.default.tokenize(t,u,l,{items:a},lexer_1.default.TokenType.Literal)}}},u.multiGeoLiteralOptionalFactory=function(t,l,e,r){if(utils_1.default.equals(t,l,e+"(")){var i=l,u=(l+=e.length+1,[]);if(lexer_1.default.CLOSE(t,l))l++;else{let e=r(t,l);if(!e)return;for(l=e.next;e;){if(u.push(e),a=lexer_1.default.CLOSE(t,l)){l=a;break}var a=lexer_1.default.COMMA(t,l);if(!a)return;if(l=a,!(e=r(t,l)))return;l=e.next}}return lexer_1.default.tokenize(t,i,l,{items:u},lexer_1.default.TokenType.Literal)}},u.geoLiteral=function(e,t){return u.collectionLiteral(e,t)||u.lineStringLiteral(e,t)||u.multiPointLiteral(e,t)||u.multiLineStringLiteral(e,t)||u.multiPolygonLiteral(e,t)||u.pointLiteral(e,t)||u.polygonLiteral(e,t)},u.fullPointLiteral=r,u.fullCollectionLiteral=function(e,t){return u.fullGeoLiteralFactory(e,t,u.collectionLiteral)},u.fullLineStringLiteral=function(e,t){return u.fullGeoLiteralFactory(e,t,u.lineStringLiteral)},u.fullMultiLineStringLiteral=function(e,t){return u.fullGeoLiteralFactory(e,t,u.multiLineStringLiteral)},u.fullMultiPointLiteral=function(e,t){return u.fullGeoLiteralFactory(e,t,u.multiPointLiteral)},u.fullMultiPolygonLiteral=function(e,t){return u.fullGeoLiteralFactory(e,t,u.multiPolygonLiteral)},u.fullPolygonLiteral=function(e,t){return u.fullGeoLiteralFactory(e,t,u.polygonLiteral)},u.fullGeoLiteralFactory=function(e,t,l){var r=u.sridLiteral(e,t);if(r){l=l(e,r.next);if(l)return lexer_1.default.tokenize(e,t,l.next,{srid:r,value:l},lexer_1.default.TokenType.Literal)}},u.geographyCollection=function(e,t){if((r=lexer_1.default.geographyPrefix(e,t))&&r!==t){var l=t,r=(t=r,lexer_1.default.SQUAT(e,t));if(r){var i=u.fullCollectionLiteral(e,t=r);if(i&&(t=i.next,r=lexer_1.default.SQUAT(e,t)))return t=r,lexer_1.default.tokenize(e,l,t,"Edm.GeographyCollection",lexer_1.default.TokenType.Literal)}}},u.geographyLineString=function(e,t){return u.geoLiteralFactory(e,t,"Edm.GeographyLineString",lexer_1.default.geographyPrefix,u.fullLineStringLiteral)},u.geographyMultiLineString=function(e,t){return u.geoLiteralFactory(e,t,"Edm.GeographyMultiLineString",lexer_1.default.geographyPrefix,u.fullMultiLineStringLiteral)},u.geographyMultiPoint=function(e,t){return i(e,t,"Edm.GeographyPoint",lexer_1.default.geographyPrefix,r)||i(e,t,"Edm.GeographyPoint",lexer_1.default.geographyPrefix,l)},u.geographyMultiPolygon=function(e,t){return u.geoLiteralFactory(e,t,"Edm.GeographyMultiPolygon",lexer_1.default.geographyPrefix,u.fullMultiPolygonLiteral)},u.geographyPoint=function(e,t){return u.geoLiteralFactory(e,t,"Edm.GeographyPoint",lexer_1.default.geographyPrefix,u.fullPointLiteral)},u.geographyPolygon=function(e,t){return u.geoLiteralFactory(e,t,"Edm.GeographyPolygon",lexer_1.default.geographyPrefix,u.fullPolygonLiteral)},u.geometryCollection=function(e,t){return u.geoLiteralFactory(e,t,"Edm.GeometryCollection",lexer_1.default.geometryPrefix,u.fullCollectionLiteral)},u.geometryLineString=function(e,t){return u.geoLiteralFactory(e,t,"Edm.GeometryLineString",lexer_1.default.geometryPrefix,u.fullLineStringLiteral)},u.geometryMultiLineString=function(e,t){return u.geoLiteralFactory(e,t,"Edm.GeometryMultiLineString",lexer_1.default.geometryPrefix,u.fullMultiLineStringLiteral)},u.geometryMultiPoint=function(e,t){return u.geoLiteralFactory(e,t,"Edm.GeometryMultiPoint",lexer_1.default.geometryPrefix,u.fullMultiPointLiteral)},u.geometryMultiPolygon=function(e,t){return u.geoLiteralFactory(e,t,"Edm.GeometryMultiPolygon",lexer_1.default.geometryPrefix,u.fullMultiPolygonLiteral)},u.geometryPoint=function(e,t){return u.geoLiteralFactory(e,t,"Edm.GeometryPoint",lexer_1.default.geometryPrefix,u.fullPointLiteral)},u.geometryPolygon=function(e,t){return u.geoLiteralFactory(e,t,"Edm.GeometryPolygon",lexer_1.default.geometryPrefix,u.fullPolygonLiteral)},u.geoLiteralFactory=i,u.primitiveLiteral=function(e,t){return u.nullValue(e,t)||u.booleanValue(e,t)||u.guidValue(e,t)||u.dateValue(e,t)||u.dateTimePeriodValue(e,t)||u.dateTimeOffsetValue(e,t)||u.timeOfDayValue(e,t)||u.decimalValue(e,t)||u.doubleValue(e,t)||u.singleValue(e,t)||u.lbyteValue(e,t)||u.byteValue(e,t)||u.int16Value(e,t)||u.int32Value(e,t)||u.int64Value(e,t)||u.stringValue(e,t)||u.durationValue(e,t)||u.binaryValue(e,t)||nameOrIdentifier_1.default.enumeration(e,t)||u.geographyCollection(e,t)||u.geographyLineString(e,t)||u.geographyMultiLineString(e,t)||u.geographyMultiPoint(e,t)||u.geographyMultiPolygon(e,t)||u.geographyPoint(e,t)||u.geographyPolygon(e,t)||u.geometryCollection(e,t)||u.geometryLineString(e,t)||u.geometryMultiLineString(e,t)||u.geometryMultiPoint(e,t)||u.geometryMultiPolygon(e,t)||u.geometryPoint(e,t)||u.geometryPolygon(e,t)}}(PrimitiveLiteral=PrimitiveLiteral||{}),exports.default=PrimitiveLiteral;
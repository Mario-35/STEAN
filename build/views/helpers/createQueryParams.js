"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createQueryParams=void 0;const authentication_1=require("../../authentication"),configuration_1=require("../../configuration"),models_1=require("../../models"),decodeUrl_1=require("../../routes/helper/decodeUrl"),blankUser_1=require("./blankUser");async function createQueryParams(r){var e=models_1.models.filteredModelFromConfig(r.config),t=await(0,authentication_1.getAuthenticatedUser)(r);const o=!0===(t=t||(0,blankUser_1.blankUser)(r)).superAdmin?Object.keys(e):!0===t.admin?Object.keys(e).filter(e=>0<r.model[e].order||99===r.model[e].createOrder||-1===r.model[e].createOrder):!0===t.canPost?Object.keys(e).filter(e=>0<r.model[e].order||99===r.model[e].createOrder||-1===r.model[e].createOrder):Object.keys(e).filter(e=>0<r.model[e].order);var i=(0,decodeUrl_1.decodeUrl)(r);if(i)return{methods:["GET"],decodedUrl:i,entity:"",options:r.querystring||"",user:t,graph:r.url.includes("$resultFormat=graph"),admin:"admin"===r.config.name,services:configuration_1.serverConfig.getAllInfos(r),_DATAS:Object.fromEntries(Object.entries(e).filter(([e,r])=>o.includes(e)&&0<r.order))}}exports.createQueryParams=createQueryParams;
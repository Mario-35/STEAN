"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createQueryHtmlString=void 0;const logger_1=require("../../logger"),helpers_1=require("../../helpers"),css_1=require("../css"),js_1=require("../js"),constants_1=require("../../constants");function createQueryHtmlString(s,r){const t=e=>e.replace(".min",""),i=s.replace(/<link /g,"\n<link ").replace(/<script /g,"\n<script ").replace(/<\/script>/g,"<\/script>\n").replace(/\r\n/g,"\n").split("\n").map(e=>e.trim()).filter(e=>""!=e.trim()),n=(e,s)=>{var r=i.indexOf(e);(0<r||0<(r=i.indexOf((0,helpers_1.removeAllQuotes)(e))))&&(i[r]=s)};if(r.user.canPost&&(r.methods.push("POST"),r.methods.push("PATCH"),r.user.canDelete)&&r.methods.push("DELETE"),r.options){let e=r.options;r.options.includes("options=")?(s=r.options.split("options="),r.options=s[1],e=s[0]):r.options="";s=e.split("&");const l=["method","id","entity","subentity","property","onlyValue"];s.forEach(e=>{e.includes("=")&&(e=e.split("="))[0]&&e[1]&&(l.includes(e[0])?r[e[0]]=(0,helpers_1.cleanUrl)(e[1]):"datas"==e[0]&&(r.datas=JSON.parse(unescape(e[1]))))})}return(0,css_1.listaddCssFiles)().forEach(e=>{n(`<link rel="stylesheet" href="${t(e)}">`,`<style>${(0,css_1.addCssFile)(e)}</style>`)}),(0,js_1.listaddJsFiles)().forEach(e=>{n(`<script src="${t(e)}"></script>`,`<script>${(0,js_1.addJsFile)(e)}</script>`)}),i.join("").replace("_PARAMS={}","_PARAMS="+JSON.stringify(r,helpers_1.bigIntReplacer)).replace("// @start@",r.results?"jsonObj = JSON.parse(`"+r.results+"`); jsonViewer.showJSON(jsonObj);":"").replace("@version@",constants_1.APP_VERSION).replace("@action@",`${r.decodedUrl.root}/${r.decodedUrl.version}/CreateObservations`)}exports.createQueryHtmlString=createQueryHtmlString;
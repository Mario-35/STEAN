const removeAllQuotes=e=>null!=e&&2<=e.length&&'"'==e.charAt(0)&&'"'===e.charAt(e.length-1)?e.substring(1,e.length-1):e;function decodeUrl(n){n=removeAllQuotes(n),header("decodeUrl",n);try{var a;let e=n,t=n,i=n;n.includes("?")&&(a=n.split("?"),e=a[0],t=a[1]);var l,o=getVersion(n);return o&&(l=e.split(o),i=l[1],e=l[0]),i.split("/").filter(e=>""!==e).forEach((e,t)=>{var i;0===t?e.includes("(")?(i=e.split("("),entityOption.value=i[0],idOption.value=i[1].replace(")","")):entityOption.value=getEntityName(e):1===t&&(e.includes("?")?queryOptions.value=e:_PARAMS._DATAS[getEntityName(e)]&&populateSelect(subentityOption,Object.keys(_PARAMS._DATAS[entityOption.value].relations),e,!0))}),t.split("&").filter(e=>""!==e.trim()).forEach(e=>{var t=e.split("=");{t[0];const e=getElement(t[0]+"Option");if(e)switch(e.type){case"checkbox":setChecked(e.id,"true"===t[1]);break;case"select-multiple":multiSelects[e.id].setValue(t[1].split(","));break;default:e.value=t[1]}}}),canShowQueryButton(),!1}catch(e){return!1}}function cleanUrl(e){for(;["$","&","?"].includes(e[e.length-1]);)e=e.slice(0,-1);return e}function createUrl(){header("createUrl");const i=[];function t(e,t){""!=t&&i.push(e+"="+t)}var n=Number(idOption.value),a=optHost.value+"/"+optVersion.value;let l=a,o=a+"/Query?&method="+methodOption.value;if(0<n?(l=l+"/"+entityOption.value+"("+n+")",o=o+`&entity=${entityOption.value}&id=`+n):"Loras"==entityOption.value&&""!=idOption.value&&"0"!=idOption.value?(l=l+"/"+entityOption.value+"("+idOption.value+")",o=o+`&entity=${entityOption.value}&id=`+n):(l=l+"/"+entityOption.value,o+="&entity="+entityOption.value),"none"!=subentityOption.value&&(l=l+"/"+subentityOption.value,o+="&subentity="+subentityOption.value),"none"!=propertyOption.value&&""!=idOption.value)l=l+"/"+propertyOption.value,o+="&property="+propertyOption.value,!0===getIfChecked("onlyValueOption")&&(l+="/$value",o+="&onlyValueOption=true");else{""!=datas.innerText&&(a=encodeURIComponent(datas.innerText),o=o+"&datas="+a),t("resultFormat",["json","logs"].includes(resultFormatOption.value)?"":resultFormatOption.value),t("debug",isDebug?"true":""),t("count",getIfChecked("countOption")?"true":""),t("valuesKeys",getIfChecked("valueskeysOption")?"true":""),isObservation()&&t("splitResult",splitResultOption.value),""!=intervalOption.value&&isObservation()&&t("interval",intervalOption.value),["","0"].includes(skipOption.value)||t("skip",skipOption.value),["","0"].includes(topOption.value)||t("top",topOption.value),(tempDatas=multiSelects.expandOption.getData())&&0<tempDatas.length&&t("expand",tempDatas),(tempDatas="logs"===resultFormatOption.value?["id","date","code","method","database"]:multiSelects.selectOption.getData())&&0<tempDatas.length&&t("select",tempDatas),tempDatas=multiSelects.orderbyOption.getData(),(tempDatas=isLog()&&tempDatas.length<1?["date desc"]:tempDatas)&&0<tempDatas.length&&t("orderby",tempDatas),""!=payload.value&&["Decoders"].includes(entityOption.value)&&t("payload",payload.value);n=getElement("query-builder").innerText;const u=[];JSON.parse(n).forEach(e=>{const i=[];e.forEach(e=>{if(e.criterium&&""!=e.criterium&&e.condition&&""!=e.criterium&&e.criterium&&""!=e.value){var t=isNaN(e.value)?`'${e.value}'`:e.value;switch(e.condition){case"contains":case"endswith":case"startswith":i.push(`${e.condition}(${e.criterium},${t})`);break;case"between":i.push(`${e.criterium} gt ${e.value.first} and ${e.criterium} lt ${e.value.second} `);break;case"nn":i.push(e.criterium+" ne null");break;case"nu":i.push(e.criterium+" eq null");break;default:i.push(`${e.criterium} ${e.condition} `+t)}}}),u.push(i.join(" and "))});let e=u.join(" or ");isLog()&&Logfilter&&(e+=Logfilter),t("filter",e);a=0<i.length?"?$":"";l=l+a+i.join("&$"),o=o+"&"+encodeURI(i.join("&")),l=cleanUrl(l),o=cleanUrl(o),isDebug}return{direct:l,query:o}}
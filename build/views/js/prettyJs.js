function pp(){this.shift=["\n"],this.step="  ";for(var e=0,e=0;e<100;e++)this.shift.push(this.shift[e]+this.step)}function js_beautify(k,e){var O,o,r,N,f,n,t,p,i,K,h,S,R,u,a,M,_,E,A,I,T,c,l,d=!1,y=(e=e||{}).braces_on_own_line||!1,J=e.indent_size||4,U=e.indent_char||" ",G=void 0===e.preserve_newlines||e.preserve_newlines,w=e.indent_level||0,H="undefined"!==e.space_after_anon_function&&e.space_after_anon_function,g=void 0!==e.keep_array_indentation&&e.keep_array_indentation,L=k.length,s=!0,x=!0;function C(){for(;o.length&&(" "===o[o.length-1]||o[o.length-1]===K);)o.pop()}function v(e){return"[EXPRESSION]"===e||"[INDENTED-EXPRESSION]"===e}function D(e){if(p.eat_next_space=!1,(!g||!v(p.mode))&&(e=void 0===e||e,p.if_line=!1,C(),o.length)){"\n"===o[o.length-1]&&e||(d=!0,o.push("\n"));for(var r=0;r<p.indentation_level;r+=1)o.push(K);p.var_line&&p.var_line_reindented&&(" "===U?o.push("    "):o.push(K))}}function P(){var e=" ";p.eat_next_space?p.eat_next_space=!1:" "!==(e=o.length?o[o.length-1]:e)&&"\n"!==e&&e!==K&&o.push(" ")}function m(){d=!1,p.eat_next_space=!1,o.push(r)}function F(){p.indentation_level+=1}function j(){o.length&&o[o.length-1]===K&&o.pop()}function B(e){p&&i.push(p),p={previous_mode:p?p.mode:"BLOCK",mode:e,var_line:!1,var_line_tainted:!1,var_line_reindented:!1,in_html_comment:!1,if_line:!1,in_case:!1,eat_next_space:!1,indentation_baseline:-1,indentation_level:p?p.indentation_level+(p.var_line&&p.var_line_reindented?1:0):w}}function b(e){return"[EXPRESSION]"===e||"[INDENTED-EXPRESSION]"===e||"(EXPRESSION)"===e}function X(){E="DO_BLOCK"===p.mode,0<i.length&&(p=i.pop())}function W(e,r){for(var n=0;n<r.length;n+=1)if(r[n]===e)return 1}for(K="";0<J;)K+=U,--J;for(O=k,N="TK_START_EXPR",f=t="",E=!(o=[]),h="\n\r\t ".split(n=""),S="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789_$".split(""),M="0123456789".split(""),R="+ - * / % & ++ -- = += -= *= /= %= == === != !== > < >= <= >> << >>> >>>= >>= <<= && &= | || ! !! , : ? ^ ^= |= ::".split(" "),a="continue,try,throw,return,var,if,switch,case,default,for,while,break,function".split(","),i=[],B("BLOCK"),u=0;;){if(T=function e(){var r,n,t,i,a,_,E,T,c,l=g&&v(p.mode),s=0;if(I=0,L<=u)return["","TK_EOF"];if(A=!1,r=O.charAt(u),u+=1,l){for(;W(r,h);){if("\n"===r?(C(),o.push("\n"),d=!0,s=0):s+="\t"===r?4:1,L<=u)return["","TK_EOF"];r=O.charAt(u),u+=1}if(-1===p.indentation_baseline&&(p.indentation_baseline=s),d){for(n=0;n<p.indentation_level+1;n+=1)o.push(K);if(-1!==p.indentation_baseline)for(n=0;n<s-p.indentation_baseline;n+=1)o.push(" ")}}else{for(;W(r,h);){if("\n"===r&&(I+=1),L<=u)return["","TK_EOF"];r=O.charAt(u),u+=1}if(G&&1<I)for(n=0;n<I;n+=1)D(0===n),d=!0;A=0<I}if(W(r,S)){if(u<L)for(;W(O.charAt(u),S)&&(r+=O.charAt(u),(u+=1)!==L););return u===L||!r.match(/^[0-9]+[Ee]$/)||"-"!==O.charAt(u)&&"+"!==O.charAt(u)?"in"===r?[r,"TK_OPERATOR"]:(!A||"TK_OPERATOR"===N||p.if_line||!G&&"var"===f||D(),[r,"TK_WORD"]):(l=O.charAt(u),u+=1,[r+=l+e()[0],"TK_WORD"])}if("("===r||"["===r)return[r,"TK_START_EXPR"];if(")"===r||"]"===r)return[r,"TK_END_EXPR"];if("{"===r)return[r,"TK_START_BLOCK"];if("}"===r)return[r,"TK_END_BLOCK"];if(";"===r)return[r,"TK_SEMICOLON"];if("/"===r){if(i=!0,t="","*"===O.charAt(u)){if((u+=1)<L)for(;("*"!==O.charAt(u)||!O.charAt(u+1)||"/"!==O.charAt(u+1))&&u<L&&(t+=r=O.charAt(u),"\r"!==r&&"\n"!==r||(i=!1),!(L<=(u+=1))););return u+=2,i?["/*"+t+"*/","TK_INLINE_COMMENT"]:["/*"+t+"*/","TK_BLOCK_COMMENT"]}if("/"===O.charAt(u)){for(t=r;"\r"!==O.charAt(u)&&"\n"!==O.charAt(u)&&(t+=O.charAt(u),!(L<=(u+=1))););return u+=1,A&&D(),[t,"TK_COMMENT"]}}if("'"===r||'"'===r||"/"===r&&("TK_WORD"===N&&W(f,["return","do"])||"TK_START_EXPR"===N||"TK_START_BLOCK"===N||"TK_END_BLOCK"===N||"TK_OPERATOR"===N||"TK_EQUALS"===N||"TK_EOF"===N||"TK_SEMICOLON"===N)){if(_=!1,E=a=r,u<L)if("/"===a){for(T=!1;_||T||O.charAt(u)!==a;)if(E+=O.charAt(u),_?_=!1:(_="\\"===O.charAt(u),"["===O.charAt(u)?T=!0:"]"===O.charAt(u)&&(T=!1)),L<=(u+=1))return[E,"TK_STRING"]}else for(;_||O.charAt(u)!==a;)if(E+=O.charAt(u),_=!_&&"\\"===O.charAt(u),L<=(u+=1))return[E,"TK_STRING"];if(u+=1,E+=a,"/"===a)for(;u<L&&W(O.charAt(u),S);)E+=O.charAt(u),u+=1;return[E,"TK_STRING"]}if("#"===r&&(c="#",u<L)&&W(O.charAt(u),M)){for(;c+=r=O.charAt(u),(u+=1)<L&&"#"!==r&&"="!==r;);return"#"!==r&&("["===O.charAt(u)&&"]"===O.charAt(u+1)?(c+="[]",u+=2):"{"===O.charAt(u)&&"}"===O.charAt(u+1)&&(c+="{}",u+=2)),[c,"TK_WORD"]}if("<"===r&&"\x3c!--"===O.substring(u-1,u+3))return u+=3,p.in_html_comment=!0,["\x3c!--","TK_COMMENT"];if("-"===r&&p.in_html_comment&&"--\x3e"===O.substring(u-1,u+2))return p.in_html_comment=!1,u+=2,A&&D(),["--\x3e","TK_COMMENT"];if(W(r,R)){for(;u<L&&W(r+O.charAt(u),R)&&(r+=O.charAt(u),!(L<=(u+=1))););return"="===r?[r,"TK_EQUALS"]:[r,"TK_OPERATOR"]}return[r,"TK_UNKNOWN"]}(),r=T[0],"TK_EOF"===(T=T[1]))break;switch(T){case"TK_START_EXPR":if("["===r){if("TK_WORD"===N||")"===f){W(f,a)&&P(),B("(EXPRESSION)"),m();break}("[EXPRESSION]"===p.mode||"[INDENTED-EXPRESSION]"===p.mode)&&("]"===n&&","===f||"["===f)?("[EXPRESSION]"===p.mode&&(p.mode="[INDENTED-EXPRESSION]",g||F()),B("[EXPRESSION]"),g||D()):B("[EXPRESSION]")}else B("(EXPRESSION)");";"===f||"TK_START_BLOCK"===N?D():"TK_END_EXPR"!==N&&"TK_START_EXPR"!==N&&"TK_END_BLOCK"!==N&&"."!==f&&("TK_WORD"!==N&&"TK_OPERATOR"!==N?P():"function"===t?H&&P():!W(f,a)&&"catch"!==f||P()),m();break;case"TK_END_EXPR":if("]"===r)if(g){if("}"===f){j(),m(),X();break}}else if("[INDENTED-EXPRESSION]"===p.mode&&"]"===f){X(),D(),m();break}X(),m();break;case"TK_START_BLOCK":B("do"===t?"DO_BLOCK":"BLOCK"),(y?("TK_OPERATOR"!==N&&("return"===f?P():D(!0)),m(),F):("TK_OPERATOR"!==N&&"TK_START_EXPR"!==N?("TK_START_BLOCK"===N?D:P)():v(p.previous_mode)&&","===f&&D(),F(),m))();break;case"TK_END_BLOCK":X(),(!y&&"TK_START_BLOCK"===N?d?j:C:D)(),m();break;case"TK_WORD":if(E)P(),m(),P(),E=!1;else{if("function"===r&&(d||";"===f)&&"{"!==f)for(I=d?I:0,c=0;c<2-I;c+=1)D(!1);"case"===r||"default"===r?(":"===f?j():(--p.indentation_level,D(),p.indentation_level+=1),m(),p.in_case=!0):(_="NONE","TK_END_BLOCK"===N?!W(r.toLowerCase(),["else","catch","finally"])||y?_="NEWLINE":(_="SPACE",P()):"TK_SEMICOLON"!==N||"BLOCK"!==p.mode&&"DO_BLOCK"!==p.mode?"TK_SEMICOLON"===N&&b(p.mode)?_="SPACE":"TK_STRING"===N?_="NEWLINE":"TK_WORD"===N?_="SPACE":"TK_START_BLOCK"===N?_="NEWLINE":"TK_END_EXPR"===N&&(P(),_="NEWLINE"):_="NEWLINE","TK_END_BLOCK"!==N&&W(r.toLowerCase(),["else","catch","finally"])?D():W(r,a)||"NEWLINE"===_?"else"===f?P():("TK_START_EXPR"!==N&&"="!==f&&","!==f||"function"!==r)&&("return"===f||"throw"===f?P():"TK_END_EXPR"!==N?"TK_START_EXPR"===N&&"var"===r||":"===f||("if"===r&&"else"===t&&"{"!==f?P:D)():W(r,a)&&")"!==f&&D()):v(p.mode)&&","===f&&"}"===n?D():"SPACE"===_&&P(),m(),"var"===(t=r)&&(p.var_line=!0,p.var_line_reindented=!1,p.var_line_tainted=!1),"if"!==r&&"else"!==r||(p.if_line=!0))}break;case"TK_SEMICOLON":m(),p.var_line=!1,p.var_line_reindented=!1;break;case"TK_STRING":"TK_START_BLOCK"===N||"TK_END_BLOCK"===N||"TK_SEMICOLON"===N?D():"TK_WORD"===N&&P(),m();break;case"TK_EQUALS":p.var_line&&(p.var_line_tainted=!0),P(),m(),P();break;case"TK_OPERATOR":if(x=s=!0,p.var_line&&","===r&&b(p.mode)&&(p.var_line_tainted=!1),p.var_line&&","===r){if(p.var_line_tainted){m(),p.var_line_reindented=!0,p.var_line_tainted=!1,D();break}p.var_line_tainted=!1}"return"===f||"throw"===f?(P(),m()):":"===r&&p.in_case?(m(),D(),p.in_case=!1):"::"===r?m():","===r?p.var_line?p.var_line_tainted?(m(),D(),p.var_line_tainted=!1):(m(),P()):("TK_END_BLOCK"===N&&"(EXPRESSION)"!==p.mode?(m(),"OBJECT"===p.mode&&"}"===f?D:P):"OBJECT"===p.mode?(m(),D):(m(),P))():(W(r,["--","++","!"])||W(r,["-","+"])&&(W(N,["TK_START_BLOCK","TK_START_EXPR","TK_EQUALS","TK_OPERATOR"])||W(f,a))?(x=s=!1,";"===f&&b(p.mode)&&(s=!0),"TK_WORD"===N&&W(f,a)&&(s=!0),"BLOCK"!==p.mode||"{"!==f&&";"!==f||D()):"."===r?s=!1:":"!==r||function(){for(var e=0,r=0,n=o.length-1;0<=n;--n)switch(o[n]){case":":0===e&&(r+=1);break;case"?":if(0===e){if(0===r)return 1;--r}break;case"{":if(0===e)return;--e;break;case"(":case"[":--e;break;case")":case"]":case"}":e+=1}}()||(s=!(p.mode="OBJECT")),s&&P(),m(),x&&P());break;case"TK_BLOCK_COMMENT":if(l=r.split(/\x0a|\x0d\x0a/),/^\/\*\*/.test(r))for(D(),o.push(l[0]),c=1;c<l.length;c+=1)D(),o.push(" "),o.push(l[c].replace(/^\s\s*|\s\s*$/,""));else for((1<l.length?(D(),C):P)(),c=0;c<l.length;c+=1)o.push(l[c]),o.push("\n");D();break;case"TK_INLINE_COMMENT":P(),m(),(b(p.mode)?P:D)();break;case"TK_COMMENT":(A?D:P)(),m(),D();break;case"TK_UNKNOWN":m()}n=f,N=T,f=r}return o.join("").replace(/[\n ]+$/,"")}function isSubquery(e,r){return r-(e.replace(/\(/g,"").length-e.replace(/\)/g,"").length)}function split_sql(e,r){return e.replace(/\s{1,}/g," ").replace(/ AND /gi,"~::~"+r+r+"AND ").replace(/ BETWEEN /gi,"~::~"+r+"BETWEEN ").replace(/ CASE /gi,"~::~"+r+"CASE ").replace(/ ELSE /gi,"~::~"+r+"ELSE ").replace(/ END /gi,"~::~"+r+"END ").replace(/ FROM /gi,"~::~FROM ").replace(/ GROUP\s{1,}BY/gi,"~::~GROUP BY ").replace(/ HAVING /gi,"~::~HAVING ").replace(/ IN /gi," IN ").replace(/ JOIN /gi,"~::~JOIN ").replace(/ CROSS~::~{1,}JOIN /gi,"~::~CROSS JOIN ").replace(/ INNER~::~{1,}JOIN /gi,"~::~INNER JOIN ").replace(/ LEFT~::~{1,}JOIN /gi,"~::~LEFT JOIN ").replace(/ RIGHT~::~{1,}JOIN /gi,"~::~RIGHT JOIN ").replace(/ ON /gi,"~::~"+r+"ON ").replace(/ OR /gi,"~::~"+r+r+"OR ").replace(/ ORDER\s{1,}BY/gi,"~::~ORDER BY ").replace(/ OVER /gi,"~::~"+r+"OVER ").replace(/\(\s{0,}SELECT /gi,"~::~(SELECT ").replace(/\)\s{0,}SELECT /gi,")~::~SELECT ").replace(/ THEN /gi," THEN~::~"+r).replace(/ UNION /gi,"~::~UNION~::~").replace(/ USING /gi,"~::~USING ").replace(/ WHEN /gi,"~::~"+r+"WHEN ").replace(/ WHERE /gi,"~::~WHERE ").replace(/ WITH /gi,"~::~WITH ").replace(/ ALL /gi," ALL ").replace(/ AS /gi," AS ").replace(/ ASC /gi," ASC ").replace(/ DESC /gi," DESC ").replace(/ DISTINCT /gi," DISTINCT ").replace(/ EXISTS /gi," EXISTS ").replace(/ NOT /gi," NOT ").replace(/ NULL /gi," NULL ").replace(/ LIKE /gi," LIKE ").replace(/\s{0,}SELECT /gi,"SELECT ").replace(/~::~{1,}/g,"~::~").split("~::~")}pp.prototype.js=function(e){return js_beautify(e)},pp.prototype.json=function(e){return"string"==typeof e?JSON.stringify(JSON.parse(e),null,this.step):"object"==typeof e?JSON.stringify(e,null,this.step):null},pp.prototype.sql=function(e){for(var r=e.replace(/\s{1,}/g," ").replace(/\'/gi,"~::~'").split("~::~"),n=r.length,t=[],i=0,a=this.step,_=0,E="",T=0,T=0;T<n;T++)t=T%2?t.concat(r[T]):t.concat(split_sql(r[T],a));for(n=t.length,T=0;T<n;T++)_=isSubquery(t[T],_),/\s{0,}\s{0,}SELECT\s{0,}/.exec(t[T])&&(t[T]=t[T].replace(/\,/g,",\n"+a+a)),/\s{0,}\(\s{0,}SELECT\s{0,}/.exec(t[T])?E+=this.shift[++i]+t[T]:/\'/.exec(t[T])?(_<1&&i&&i--,E+=t[T]):(E+=this.shift[i]+t[T],_<1&&i&&i--);return E=E.replace(/^\n{1,}/,"").replace(/\n{1,}/g,"\n")};
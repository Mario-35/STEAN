"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.getAuthenticatedUser=void 0;const _1=require("."),dataAccess_1=require("../db/dataAccess"),helpers_1=require("../helpers"),blankUser_1=require("../views/helpers/blankUser"),getAuthenticatedUser=async e=>{if(!1===e.config.users)return(0,blankUser_1.blankUser)(e);e=(0,_1.decodeToken)(e);if(e&&0<e.id){var r=await dataAccess_1.userAccess.getSingle(e.id);if(r&&null!==e.password.match((0,helpers_1.decrypt)(r.password)))return Object.freeze(r)}};exports.getAuthenticatedUser=getAuthenticatedUser;
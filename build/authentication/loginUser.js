"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.loginUser=void 0;const _1=require("."),configuration_1=require("../configuration"),helpers_1=require("../helpers"),loginUser=async e=>{if(e.body.username&&e.body.password){var r=await configuration_1.serverConfig.connection(e.config.name)`SELECT * FROM "user" WHERE username = ${e.body.username} LIMIT 1`;if(1===r.length){var o,r={...r[0]};if(r&&e.body&&null!==e.body.password.match((0,helpers_1.decrypt)(r.password)))return o=(0,_1.createToken)(r,e.body.password),e.cookies.set("jwt-session",o),r.token=o,Object.freeze(r)}else e.throw(404)}else e.throw(401)};exports.loginUser=loginUser;
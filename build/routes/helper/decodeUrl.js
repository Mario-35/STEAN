"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.decodeUrl=void 0;const _1=require("."),configuration_1=require("../../configuration"),constants_1=require("../../constants"),enums_1=require("../../enums"),helpers_1=require("../../helpers"),messages_1=require("../../messages"),decodeUrl=(i,o)=>{o=o||i.href,(0,constants_1.setDebug)(o.includes("?$debug=true")||o.includes("&$debug=true"));o=new URL((0,helpers_1.cleanUrl)(o.replace("$debug=true","").normalize("NFD").replace(/[\u0300-\u036f]/g,"")));let t=(0,_1.getConfigFromPort)(+o.port);var n=o.pathname.split("/").filter(e=>""!=e);if(!n[0])throw new Error(messages_1.errors.noNameIdentified);if(t=t||configuration_1.serverConfig.getConfigNameFromName(n[0].toLowerCase())){i=configuration_1.serverConfig.getInfos(i,t);let e=void 0,r=0,s="/";return n[2]&&(r=n[2].includes("(")?n[2].split("(")[1].split(")")[0]:0,e=isNaN(+r)?String(r).toLocaleUpperCase():void 0,s=n.slice(2).join("/")),{search:o.search,service:n[0],version:n[0]===constants_1.ADMIN?enums_1.EnumVersion.v1_0:n[1],path:e?s.replace(String(r),"0"):s,id:isNaN(+r)?BigInt(0):BigInt(r),idStr:e,configName:t,linkbase:i.linkBase,root:i.root}}};exports.decodeUrl=decodeUrl;
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.createInsertValues=void 0;const _1=require("."),__1=require(".."),constants_1=require("../../constants"),helpers_1=require("../../helpers"),logger_1=require("../../logger");function createInsertValues(e,s,t){if(e&&s){const r=[],o=[];if(t){const u=__1.models.getEntity(e,t);if(!u)return"";Object.keys(s).forEach(e=>{var t;s[e]&&u.columns[e]?(t=(0,_1.formatColumnValue)(e,s[e],u.columns[e].type))&&(r.push((0,helpers_1.addDoubleQuotes)(e)),o.push(t)):s[e]&&u.relations[e]&&(t=u.relations[e].entityColumn,u.columns[t])&&(e=(0,_1.formatColumnValue)(t,s[e],u.columns[t].type))&&(r.push((0,helpers_1.addDoubleQuotes)(t)),o.push(e))})}else Object.keys(s).forEach(e=>{s[e]&&(s[e].startsWith&&s[e].startsWith('"{')&&s[e].endsWith('}"')?s[e]=(0,helpers_1.removeDoubleQuotes)(s[e]):s[e].startsWith&&s[e].startsWith('{"@iot.name"')&&(s[e]=`(SELECT "id" FROM "${e.split("_")[0]}" WHERE "name" = '${JSON.parse((0,helpers_1.removeDoubleQuotes)(s[e]))["@iot.name"]}')`),r.push((0,helpers_1.addDoubleQuotes)(e)),o.push("string"==typeof s[e]?s[e].startsWith("(SELECT")?s[e]:(0,helpers_1.addSimpleQuotes)((0,constants_1.ESCAPE_SIMPLE_QUOTE)(s[e].trim())):"result"===e?`'{"value": ${s[e]}}'::jsonb`:(0,constants_1.ESCAPE_SIMPLE_QUOTE)(s[e].trim())))});return`(${r.join()}) VALUES (${o.join()})`}return""}exports.createInsertValues=createInsertValues;